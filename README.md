# Определение стоимости автомобилей


<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#1.-Подготовка-данных" data-toc-modified-id="1.-Подготовка-данных-1">1. Подготовка данных</a></span><ul class="toc-item"><li><span><a href="#Вывод" data-toc-modified-id="Вывод-1.1">Вывод</a></span></li></ul></li><li><span><a href="#2.-Анализ-и-обработка-данных" data-toc-modified-id="2.-Анализ-и-обработка-данных-2">2. Анализ и обработка данных</a></span><ul class="toc-item"><li><span><a href="#2.1-Пропуски" data-toc-modified-id="2.1-Пропуски-2.1">2.1 Пропуски</a></span></li><li><span><a href="#2.2-Анализ-данных" data-toc-modified-id="2.2-Анализ-данных-2.2">2.2 Анализ данных</a></span></li><li><span><a href="#2.3-Корреляция" data-toc-modified-id="2.3-Корреляция-2.3">2.3 Корреляция</a></span></li></ul></li><li><span><a href="#3.-Обучение-моделей" data-toc-modified-id="3.-Обучение-моделей-3">3. Обучение моделей</a></span><ul class="toc-item"><li><span><a href="#3.1-Разделение-и-кодирование-выборок" data-toc-modified-id="3.1-Разделение-и-кодирование-выборок-3.1">3.1 Разделение и кодирование выборок</a></span></li><li><span><a href="#3.2-LightGBM" data-toc-modified-id="3.2-LightGBM-3.2">3.2 LightGBM</a></span></li><li><span><a href="#3.3-Catboost" data-toc-modified-id="3.3-Catboost-3.3">3.3 Catboost</a></span></li><li><span><a href="#3.4-Simpleboost-(ohe)" data-toc-modified-id="3.4-Simpleboost-(ohe)-3.4">3.4 Simpleboost (ohe)</a></span></li><li><span><a href="#3.5-RandomForest-(ohe)" data-toc-modified-id="3.5-RandomForest-(ohe)-3.5">3.5 RandomForest (ohe)</a></span></li><li><span><a href="#3.6-Simpleboost-(oe)" data-toc-modified-id="3.6-Simpleboost-(oe)-3.6">3.6 Simpleboost (oe)</a></span></li><li><span><a href="#3.7-RandomForest-(oe)" data-toc-modified-id="3.7-RandomForest-(oe)-3.7">3.7 RandomForest (oe)</a></span></li><li><span><a href="#3.8-ohe-vs-oe" data-toc-modified-id="3.8-ohe-vs-oe-3.8">3.8 ohe vs oe</a></span></li></ul></li><li><span><a href="#4.-Анализ-моделей" data-toc-modified-id="4.-Анализ-моделей-4">4. Анализ моделей</a></span></li></ul></div>


## Описание проекта
Сервис по продаже автомобилей с пробегом разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В вашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Нам нужно построить модель для определения стоимости. 

**Заказчику важны:**
- качество предсказания;
- скорость предсказания;
- время обучения.

## Описание данных
**Признаки:**
* `DateCrawled` — дата скачивания анкеты из базы
* `VehicleType` — тип автомобильного кузова
* `RegistrationYear` — год регистрации автомобиля
* `Gearbox` — тип коробки передач
* `Power` — мощность (л. с.)
* `Model` — модель автомобиля
* `Kilometer` — пробег (км)
* `RegistrationMonth` — месяц регистрации автомобиля
* `FuelType` — тип топлива
* `Brand` — марка автомобиля
* `NotRepaired` — была машина в ремонте или нет
* `DateCreated` — дата создания анкеты
* `NumberOfPictures` — количество фотографий автомобиля
* `PostalCode` — почтовый индекс владельца анкеты (пользователя)
* `LastSeen` — дата последней активности пользователя

**Целевой признак:**
* `Price` — цена (евро)

## Задача
Необходимо построить модель для определения стоимости.
* Обучить разные модели. Для каждой попробовать различные гиперпараметры. (+ анализ скорости работы и качества моделей)
* Для оценки качества моделей применяем метрику `RMSE`.
* Значение метрики `RMSE` должно быть меньше `2500`.
* Изменять у модели только два-три параметра.

**Доп. задача:**
* Сравнить прямое и порядковое кодирование переменных.


## Вывод
Мы провели анализ и обработку данных. Подготовили их и обучили модели на их основе. Нашли лучшие гиперпараметры для моделей и протестировали их на тестовой выборке, применив метрику RMSE.


| |Model|	Train RMSE|	Test RMSE|	Train Time, sec| Test Time, sec|
|-|-----|-----------|----------|-----------------|---------------|
|0|	LightGBM|	1623.023|	1606.584|	10.4 сек.|	1.35 сек.|
|1|	Catboost|	1669.798|	1606.584|	39 сек.|	7.16 сек.|
|2|	RandomForest|	1040.796|	1768.556|	2 м. 24 сек.|	817 мс.|
|3|	Simpleboost|	1483.384|	1733.330|	8 м. 56 сек.|	17.8 сек.|

* Все рассмотренные модели преодолели порог в 2500.
* Наименьшую ошибку на тесте выдают `CatBoost` и `LightGBM`.
* `LightGBM` самая лучшая модель из всех (по скорости и по скору).
* Похоже `RandomForest` и `Simpleboost` переобучились на тренировочной выборке, но показили примерно похожий скор на тесте
* `Simpleboost` самая долгая модель из всех.

Основываясь на этом, можно сделать вывод, что лучше всего подойдет модель построенная на `LightGBM`
